---
title: "Note:Deep Learning for Event-Driven Stock Prediction"
data: 2018-12-9
tags: "Notes"
---
# Deep Learning for Event-Driven Stock Prediction

> 本文提出了一种基于事件驱动的股票价格预测的深度学习方法。首先，从新闻文本中提取事件，将事件表示为密集向量，用一种新的神经张量网络进行训练。第二采用深度卷积网络对长期和短期事件对股票价格的影响进行建模。最终得出一个在S&P 500指数上表现比state-of-art baseline method好6%的模型。

#### Introduction

1. Pioneering work: bags-of-words,noun phares, and named entities.这些特征虽然有用但是不能捕捉到结构化关系。

2. 事件结构化表示的一个缺点是他们会导致稀疏性增加，这可能限制预测的能力。在这篇文章中使用一种新的神经张量网络(NTN)来训练事件嵌入，它可以像标准神经网络那样讲事件参数组合而不是隐式地学习事件参数的语义组成。

####  Neural Tensor Network for Learning Event Embeddings

>首先使用**ReVerb**来提取事件的候选元组，然后用**ZPar**解析句子来提取句子的主语，宾语，谓语。用Open IE和依赖关系从文本中提取结构化事件。

2. The input of neural tensor network is word embeddings and the output is event embeddings. The dimension is 100，using **skip-gram** algorithm.

3. Algorithm 1,是训练的伪代码。 In our case, pre-trained word embeddings give slightly better results than randomly initialized embeddings.

#### Deep Prediction Model

1. 长期事件是过去几个月的事件，中期事件是过去几周的事件，短期事件是过去几天的事件。The input to the model is a sequence of event embeddings, the output of the model is a binary class.(1 是上涨，-1 是下降)。

2. 采用卷积的方法，滑动选取长期，中期的特征，然后使用池化，将最突出的特征表示出来。如Fig.3所示。

#### Experiments

> 使用来自路透社和彭博在2006.10至2013.11期间的金融新闻，从新闻标题中提取数据，对S&P500机器个股进行预测，采用ACC和MCC对预测进行评价。本文还评估了模型的可变性。

1. 对于S&P500指数，通过控制变量法，从Table 2中，我们发现event-embedding-based is better than word-embedding-based model. 基于事件嵌入的模型比基于事件的性能更优。CNN-based is better than NN-based.

2. 对于单只股票的预测，通过对大中小型不同股票的结果观察，本文的预测估计准确率也高于市场上先进的模型。

3. 真实的股票交易，如果当天的股票模型表明单只股票会上涨，第二天，虚拟的投资者会投资一万美元，以开盘价买入股票。如果在当天股票可以赚取2%的利润，交易者立即卖出。否则在一天结束时，交易者出售全部股票。当前一天没有相关的股票报道是，本文提出的模型也能进行预测。

4. 更好的阀值，通过Fig.5我们可以看出当threshold=0.7时，收益能达到最大化。

### 感想

- 本文提出了一种新的学习事件嵌入的神经张量网络，并且用深度神经网络对长短期事件对股价波动进行预测。首先是建立通过机器学习建立一个EELM，然后通过其对新闻的标题进行embedding. 最后通过CNN对长短期的事件一同训练，得出预测的结果。并且该结果比以前的结果准确率更高。

- 本文的股票预测模型中，结合长期和短期事件影响，用CNN来提取特征，然后用池化层保留最有用的特征。并且实验证明，这个办法相当有效。这也是因为人工智能不断发展，不断地有新的层，结构等被人提出，使得学习的准确率逐步上升。

- 这个模型其实存在很大的**风险**。如果对手盘捕捉到了模型的逻辑，然后在社交媒体上释放一些特定的消息，使模型判断错误，从中获利。（通过释放利好信息，诱导模型买入，然后压低股价，模型按照预先的设置在下跌一定限度的时候就会卖出股票，这样模型就会亏损，对手盘获利）。

### 改进

- 本文使用CNN作为对长期事件，中期事件提取特征的一个工具，并且得到了更好的结果。随着时代的发展，对于这种时间序列型的数据，我们可以使用LSTM(长短期记忆神经网络)。并且作者只是粗略地将一段事件发生的事情划分到长短期中，并且使用3*3的卷积进行提取信息，这就说明其实只是这三个相邻的事件产生影响然后再池化。如果使用LSTM，我们甚至能对每一天进行一个输入(若没有新闻可以输入0)，基于LSTM，可能可以开发出更好的股票预测工具。

- 在这篇论文的市场仿真中，交易者会以固定的价格买卖股票，但是我们知道，股票交易的价格其实是会受购买热情影响。也就是，当我们交易的资金足以影响股价的时候，我们的购买会拉高股票的价格，售出会打压股票的价格。导致实际收益其实并不如理想收益。

- 如果一只股票在开市前发布了一个重大利好消息(如超出市场预期的财报)，这时候这支股票极大可能会跳空高开，但是因为当时市场有极大的下行趋势，在盘中可能会逐步下跌，也就是高开低走。根据本文的算法，那么会在市场的结果上是正确的，但是在个股的结果是错误的，导致亏损。这时候如果能加一个市场的影响因子，或许能避免这种情况的出现。

- 在本篇论文中，我们是用单日的涨跌作为学习，判断的结果。在目前量化行业中，有一个14日换手的说法，我们可以讲对单日涨跌的预测换成对14日涨跌的预测。(也就是将我们的交易，换手周期延长)观察是否能有更好的效果。
